<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>0322-deprecate-copy-copyable - </title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="affix"><a href="introduction.html">Introduction</a></li><li><a href="0001-transform-attribute-meta-parameter.html">0001-transform-attribute-meta-parameter</a></li><li><a href="0003-block-params.html">0003-block-params</a></li><li><a href="0003-cli-ember-doctor.html">0003-cli-ember-doctor</a></li><li><a href="0010-engines.html">0010-engines</a></li><li><a href="0011-improved-cp-syntax.html">0011-improved-cp-syntax</a></li><li><a href="0012-help-json-output.html">0012-help-json-output</a></li><li><a href="0015-the-road-to-ember-2-0.html">0015-the-road-to-ember-2-0</a></li><li><a href="0020-sri-default.html">0020-sri-default</a></li><li><a href="0023-command-line-completion.html">0023-command-line-completion</a></li><li><a href="0024-bound-attributes.html">0024-bound-attributes</a></li><li><a href="0028-app-import-output-file.html">0028-app-import-output-file</a></li><li><a href="0029-addon-black-and-whitelist-for-apps.html">0029-addon-black-and-whitelist-for-apps</a></li><li><a href="0045-internet-explorer.html">0045-internet-explorer</a></li><li><a href="0046-cli-improved-release-process.html">0046-cli-improved-release-process</a></li><li><a href="0046-registry-reform.html">0046-registry-reform</a></li><li><a href="0050-cli-production-code-stripping.html">0050-cli-production-code-stripping</a></li><li><a href="0050-improved-actions.html">0050-improved-actions</a></li><li><a href="0053-helpers.html">0053-helpers</a></li><li><a href="0055-anonymous-amd.html">0055-anonymous-amd</a></li><li><a href="0056-improved-release-cycle.html">0056-improved-release-cycle</a></li><li><a href="0057-ember-data-reference-unification.html">0057-ember-data-reference-unification</a></li><li><a href="0058-helper-listing.html">0058-helper-listing</a></li><li><a href="0061-ember-data-background-fetch.html">0061-ember-data-background-fetch</a></li><li><a href="0064-contextual-component-lookup.html">0064-contextual-component-lookup</a></li><li><a href="0065-deprecation-warning-handlers.html">0065-deprecation-warning-handlers</a></li><li><a href="0080-serve-file-api.html">0080-serve-file-api</a></li><li><a href="0086-firefox-in-ci.html">0086-firefox-in-ci</a></li><li><a href="0090-addon-tree-caching.html">0090-addon-tree-caching</a></li><li><a href="0091-cli-addon-instrumentation-experimental-hooks.html">0091-cli-addon-instrumentation-experimental-hooks</a></li><li><a href="0091-weakmap.html">0091-weakmap</a></li><li><a href="0092-blueprint-remove-old-files.html">0092-blueprint-remove-old-files</a></li><li><a href="0095-cli-standardise-targets.html">0095-cli-standardise-targets</a></li><li><a href="0095-router-service.html">0095-router-service</a></li><li><a href="0096-enable-yarn-usage.html">0096-enable-yarn-usage</a></li><li><a href="0101-ember-data-friendly-errors.html">0101-ember-data-friendly-errors</a></li><li><a href="0105-addons-optionalDependencies.html">0105-addons-optionalDependencies</a></li><li><a href="0108-add-custom-transform.html">0108-add-custom-transform</a></li><li><a href="0110-packaging.html">0110-packaging</a></li><li><a href="0114-add-template-lint-addon.html">0114-add-template-lint-addon</a></li><li><a href="0116-qunit-dom.html">0116-qunit-dom</a></li><li><a href="0120-cli-guides.html">0120-cli-guides</a></li><li><a href="0120-route-serializers.html">0120-route-serializers</a></li><li><a href="0121-remove-ember-cli-eslint.html">0121-remove-ember-cli-eslint</a></li><li><a href="0136-contains-to-includes.html">0136-contains-to-includes</a></li><li><a href="0139-isHtmlSafe.html">0139-isHtmlSafe</a></li><li><a href="0143-module-unification.html">0143-module-unification</a></li><li><a href="0150-factory-for.html">0150-factory-for</a></li><li><a href="0176-javascript-module-api.html">0176-javascript-module-api</a></li><li><a href="0178-deprecate-ember-k.html">0178-deprecate-ember-k</a></li><li><a href="0181-deprecate-ember-data-initializers.html">0181-deprecate-ember-data-initializers</a></li><li><a href="0186-track-unique-history-location-state.html">0186-track-unique-history-location-state</a></li><li><a href="0191-deprecate-component-lifecycle-hook-args.html">0191-deprecate-component-lifecycle-hook-args</a></li><li><a href="0194-deprecate-custom-event-manager.html">0194-deprecate-custom-event-manager</a></li><li><a href="0213-custom-components.html">0213-custom-components</a></li><li><a href="0225-ember-engines-mount-params.html">0225-ember-engines-mount-params</a></li><li><a href="0226-named-blocks.html">0226-named-blocks</a></li><li><a href="0229-deprecate-testing-restricted-resolver.html">0229-deprecate-testing-restricted-resolver</a></li><li><a href="0232-simplify-qunit-testing-api.html">0232-simplify-qunit-testing-api</a></li><li><a href="0236-deprecation-ember-string.html">0236-deprecation-ember-string</a></li><li><a href="0237-deprecation-ember-map.html">0237-deprecation-ember-map</a></li><li><a href="0240-es-classes.html">0240-es-classes</a></li><li><a href="0252-browser-support-changes.html">0252-browser-support-changes</a></li><li><a href="0268-acceptance-testing-refactor.html">0268-acceptance-testing-refactor</a></li><li><a href="0272-deprecation-native-function-prototype-extensions.html">0272-deprecation-native-function-prototype-extensions</a></li><li><a href="0276-named-args.html">0276-named-args</a></li><li><a href="0278-template-only-components.html">0278-template-only-components</a></li><li><a href="0280-remove-application-wrapper.html">0280-remove-application-wrapper</a></li><li><a href="0281-es5-getters.html">0281-es5-getters</a></li><li><a href="0286-block-let-template-helper.html">0286-block-let-template-helper</a></li><li><a href="0287-promote-in-element-to-public-api.html">0287-promote-in-element-to-public-api</a></li><li><a href="0293-record-data.html">0293-record-data</a></li><li><a href="0294-optional-jquery.html">0294-optional-jquery</a></li><li><a href="0297-deprecate-ember-logger.html">0297-deprecate-ember-logger</a></li><li><a href="0300-rfc-process-update.html">0300-rfc-process-update</a></li><li><a href="0308-deprecate-property-lookup-fallback.html">0308-deprecate-property-lookup-fallback</a></li><li><a href="0311-angle-bracket-invocation.html">0311-angle-bracket-invocation</a></li><li><a href="0318-array-helper.html">0318-array-helper</a></li><li><a href="0322-deprecate-copy-copyable.html" class="active">0322-deprecate-copy-copyable</a></li><li><a href="0324-deprecate-component-isvisible.html">0324-deprecate-component-isvisible</a></li><li><a href="0326-ember-data-filter-deprecation.html">0326-ember-data-filter-deprecation</a></li><li><a href="0329-deprecated-ember-evented-in-ember-data.html">0329-deprecated-ember-evented-in-ember-data</a></li><li><a href="0331-deprecate-globals-resolver.html">0331-deprecate-globals-resolver</a></li><li><a href="0332-ember-data-record-links-and-meta.html">0332-ember-data-record-links-and-meta</a></li><li><a href="0335-deprecate-send-action.html">0335-deprecate-send-action</a></li><li><a href="0337-native-class-constructor-update.html">0337-native-class-constructor-update</a></li><li><a href="0340-deprecate-ember-merge.html">0340-deprecate-ember-merge</a></li><li><a href="0345-discord.html">0345-discord</a></li><li><a href="0364-roadmap-2018.html">0364-roadmap-2018</a></li><li><a href="0369-deprecate-computed-clobberability.html">0369-deprecate-computed-clobberability</a></li><li><a href="0370-deprecate-computed-volatile.html">0370-deprecate-computed-volatile</a></li><li><a href="0372-ember-data-model-factory-for.html">0372-ember-data-model-factory-for</a></li><li><a href="0373-Element-Modifier-Managers.html">0373-Element-Modifier-Managers</a></li><li><a href="0375-deprecate-computed-property-modifier.html">0375-deprecate-computed-property-modifier</a></li><li><a href="0386-remove-jquery.html">0386-remove-jquery</a></li><li><a href="0389-dynamic-tag-names.html">0389-dynamic-tag-names</a></li><li><a href="0391-router-helpers.html">0391-router-helpers</a></li><li><a href="0392-deprecate-component-manager-string-lookup.html">0392-deprecate-component-manager-string-lookup</a></li><li><a href="0395-ember-data-packages.html">0395-ember-data-packages</a></li><li><a href="0398-RouteInfo-Metadata.html">0398-RouteInfo-Metadata</a></li><li><a href="0403-ember-data-identifiers.html">0403-ember-data-identifiers</a></li><li><a href="0408-decorators.html">0408-decorators</a></li><li><a href="0410-tracked-properties.html">0410-tracked-properties</a></li><li><a href="0415-render-element-modifiers.html">0415-render-element-modifiers</a></li><li><a href="0416-glimmer-components.html">0416-glimmer-components</a></li><li><a href="0418-deprecate-route-render-methods.html">0418-deprecate-route-render-methods</a></li><li><a href="0421-deprecate-application-controller-props.html">0421-deprecate-application-controller-props</a></li><li><a href="0425-website-redesign.html">0425-website-redesign</a></li><li><a href="0431-guides-restructure.html">0431-guides-restructure</a></li><li><a href="0432-contextual-helpers.html">0432-contextual-helpers</a></li><li><a href="0435-modifier-splattributes.html">0435-modifier-splattributes</a></li><li><a href="0440-decorator-support.html">0440-decorator-support</a></li><li><a href="0445-deprecate-with.html">0445-deprecate-with</a></li><li><a href="0446-contribution-guides.html">0446-contribution-guides</a></li><li><a href="0449-deprecate-partials.html">0449-deprecate-partials</a></li><li><a href="0451-injection-parameter-normalization.html">0451-injection-parameter-normalization</a></li><li><a href="0452-ember-data-medium-term-plan.html">0452-ember-data-medium-term-plan</a></li><li><a href="0457-nested-lookups.html">0457-nested-lookups</a></li><li><a href="0459-angle-bracket-built-in-components.html">0459-angle-bracket-built-in-components</a></li><li><a href="0460-yieldable-named-blocks.html">0460-yieldable-named-blocks</a></li><li><a href="0461-ember-data-singleton-record-data.html">0461-ember-data-singleton-record-data</a></li><li><a href="0463-record-data-state.html">0463-record-data-state</a></li><li><a href="0465-record-data-errors.html">0465-record-data-errors</a></li><li><a href="0466-request-state-service.html">0466-request-state-service</a></li><li><a href="0468-classic-decorator.html">0468-classic-decorator</a></li><li><a href="0470-fn-helper.html">0470-fn-helper</a></li><li><a href="0471-on-modifier.html">0471-on-modifier</a></li><li><a href="0478-tracked-properties-updates.html">0478-tracked-properties-updates</a></li><li><a href="0481-component-templates-co-location.html">0481-component-templates-co-location</a></li><li><a href="0486-deprecate-mouseenter.html">0486-deprecate-mouseenter</a></li><li><a href="0487-custom-model-classes.html">0487-custom-model-classes</a></li><li><a href="0491-deprecate-disconnect-outlet.html">0491-deprecate-disconnect-outlet</a></li><li><a href="0494-async-observers.html">0494-async-observers</a></li><li><a href="0521-find-by-identifier.html">0521-find-by-identifier</a></li><li><a href="0522-default-serializers-and-adapters.html">0522-default-serializers-and-adapters</a></li><li><a href="0523-model-argument-for-route-templates.html">0523-model-argument-for-route-templates</a></li><li><a href="0554-deprecate-getwithdefault.html">0554-deprecate-getwithdefault</a></li><li><a href="0558-edition-detection.html">0558-edition-detection</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title"></h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <ul>
<li>2018-03-24</li>
<li>RFC PR: 322</li>
<li>Ember Issue: (leave this empty)</li>
</ul>
<h1><a class="header" href="#deprecation-of-embercopy-and-embercopyable" id="deprecation-of-embercopy-and-embercopyable">Deprecation of Ember.copy and Ember.Copyable</a></h1>
<h2><a class="header" href="#summary" id="summary">Summary</a></h2>
<p>This RFC recommends the deprecation and eventual removal of <code>Ember.copy</code> and the <code>Ember.Copyable</code> mixin.</p>
<h2><a class="header" href="#motivation" id="motivation">Motivation</a></h2>
<p>A deep-copy mechanism is certainly useful, but it is a general JavaScript problem. Ember itself doesn't need to offer one, especially one that Ember itself isn't using internally. This function and its accompanying mixin arrived with SproutCore, a long time ago, and are not used by Ember itself, even though they currently reside in <code>@ember/object/internals</code>.</p>
<p><code>ember-data</code> uses <code>Ember.copy</code> to do deep-copies. However, the <code>ember-data</code> team finds its needs would be better served by a private deep-copy mechanism that doesn't flow inadvertently through external interfaces into the <code>Ember.copy</code> methods of user-supplied objects. These interfaces are not designed to support deep copies of user-supplied data, and it can raise havoc in the form of hard-to-diagnose bugs, especially in test scenarios.</p>
<p>Since <code>ember</code> and <code>ember-data</code> do not intend to use this mechanism going forward, it would be better to remove it from the Ember codebase and extract it into an add-on for those who wish to continue to use it.</p>
<h2><a class="header" href="#detailed-design" id="detailed-design">Detailed design</a></h2>
<p>There are four steps to deprecating any function:</p>
<ul>
<li>logging the deprecation in the call</li>
<li>removal of calls to the function from ember and any add-ons that ship with ember-cli</li>
<li>extraction to an add-on</li>
<li>eventual removal of the feature in the stated release (in this case 4.0.0).</li>
</ul>
<p>This RFC deprecates the <code>copy</code> function and <code>Copyable</code> mixin of <code>@ember/object/internals</code>.</p>
<p>Shallow copies of the form  <code>copy(x)</code>  or <code>copy(x, false)</code> can be replaced mechanically with <code>Object.assign({}, x)</code>. The simplest way to deal with deep copies in any situation depends upon the nature of the data involved.</p>
<h3><a class="header" href="#current-internal-uses" id="current-internal-uses">Current internal uses</a></h3>
<h4><a class="header" href="#ember-source" id="ember-source"><code>ember-source</code></a></h4>
<p>This following modules in <code>packages/ember-runtime/lib</code> implement the code being deprecated:</p>
<ul>
<li><code>copy.js</code> contains the <code>copy()</code> function that will log the deprecation before executing,</li>
<li><code>mixins/copyable.js</code> provides the <code>Copyable</code> mixin, but it contains no executable code to deprecate.</li>
<li><code>mixins/array.js</code> - The <code>NativeArray</code> mixin extends the <code>Copyable</code> mixin and implements <code>copy()</code>.</li>
</ul>
<p>The following tests in <code>packages/ember-runtime/tests</code> use the implementation above:</p>
<ul>
<li><code>core/copy_test.js</code> tests the <code>copy()</code> method itself.</li>
<li><code>copyable-array/copy-test.js</code> tests the <code>copy()</code> method of a <code>NativeArray</code> for identical results.</li>
<li><code>helpers/array.js</code> provides the arrays used by the <code>NativeArray</code> test above.</li>
<li><code>system/native_array/copyable_suite_test.js</code> tests the independence of the results of deep copying a <code>NativeArray</code></li>
</ul>
<p>The route  <code>packages/ember-routing/lib/system/route.js</code> has one shallow copy, but the test  <code>packages/ember/tests/routing/decoupled_basic_test</code> is using deep copy.</p>
<p>The <code>copy()</code> methods in <code>packages/ember-metal/lib/map.js</code> and  <code>chains.js</code> and their use in <code>meta.js</code>, and  <code>map_test.js</code> are unrelated.</p>
<p>At present, the handling of arrays in <code>Ember.copy</code> is inconsistent. <code>NativeArray</code> uses the <code>Copyable</code> mixin and implements a <code>copy</code> method. When calling <code>Ember.copy</code>, passing a <code>NativeArray</code>, it will note that the passed parameter uses <code>Copyable</code> and call the copy method inside  <code>NativeArray</code>. However, the recursive <code>_copy</code> method that <code>Ember.copy</code> calls for other objects has its own generic mechanism for copying arrays. If <code>copy</code> is passed a non-<code>Copyable</code> object that contains a <code>NativeArray</code> as a member, when the recursion gets to that member, it will use the generic mechanism rather than delegating to the <code>copy</code> method within the  <code>NativeArray</code>.</p>
<p>The recursive  <code>_copy</code> method also has an assertion that will fail if it is called with any <code>EmberObject</code> that is not also <code>Copyable</code>. This assertion occurs before (and hence affects) the code which handles arrays, even though, for arrays, the object's <code>copy</code> method isn't then used.</p>
<p>During the deprecation period, the <code>Ember.copy</code> method and the <code>NativeArray.copy</code> methods will carry a deprecation warning. We will remove <code>Copyable</code> from <code>NativeArray</code> and change  <code>Ember.copy</code> to consistently use the common array copy mechanism to copy arrays rather than sometimes delegating. We will move the assertion that an <code>EmberObject</code> must be  <code>Copyable</code> to the clause that handles non-array objects.</p>
<p>We need a way to deprecate use of the <code>Copyable</code> mixin. If the penalty for adding code in such a common place isn't too high, we could have <code>core_object.extend()</code>  check for <code>Copyable</code> and deprecate accordingly. We will also supply a new eslint warning that flags the deprecated use of <code>Copyable</code>. (This may be our first eslint check for deprecations. We may want to consider adding others at the same time.)</p>
<p>Those using the add-on will need to mechanically adjust any uses of  <code>myArray.copy(deep)</code> to  <code>copy(myArray, deep)</code> in order to avoid the deprecation message.</p>
<p>At the end of this period, we will remove the deprecated copy() method, the Copyable mixin, and the deprecated NativeArray.copy() method.</p>
<h4><a class="header" href="#ember-data" id="ember-data"><code>ember-data</code></a></h4>
<p>The following code in <code>ember-data</code> uses <code>copy()</code>, but only for shallow copies:</p>
<ul>
<li><code>addon/-private/system/model/internal-model.js</code> - one use</li>
<li><code>addon/-private/system/snapshot.js</code> - two uses</li>
<li><code>addon/-private/system/store.js</code> - one use</li>
</ul>
<p>All of the following uses in tests perform deep copies:</p>
<ul>
<li><code>tests/integration/adapter/build-url-mixin-test.js</code> - two uses</li>
<li><code>tests/integration/adapter/rest-adapter-test.js</code> - two uses</li>
<li><code>tests/integration/store-test.js</code> - two uses</li>
<li><code>tests/unit/system/relationships/polymorphic-relationship-payloads-test.js</code> - four uses</li>
</ul>
<p>The <code>copy()</code> methods referenced in <code>addon/-private/system.map.js</code> and  <code>addon/-private/system/relationships/state/relationship.js</code> are unrelated.</p>
<p>It would appear that deep copy is used within these packages only during testing, and generally to ensure fresh test data without side-effects.</p>
<h3><a class="header" href="#current-external-uses" id="current-external-uses">Current external uses</a></h3>
<p>The key considerations for add-ons or apps looking for an alternative to copy() and Copyable are:</p>
<ul>
<li>Do they call <code>copy()</code> to do shallow copies or deep copies?</li>
<li>If deep copies are being performed, are the objects involved POJOs or are they derived from <code>EmberObject</code>?</li>
<li>Do they provide objects that use the <code>Copyable</code> mixin with <code>copy()</code> methods intended for use in deep copies by other classes?</li>
<li>Is the data you are copying the sort of thing where you can do the copy in its behalf, or does it require collaboration from the object itself? Or are the contents so open-ended that you can't possibly know?</li>
</ul>
<p>Shallow copies are directly supported by ES6. It's easy to perform recursive deep copies for most simple POJOs without delegating work to the object you are copying. For more complex data, you may need some kind of recursive delegation. <code>Copyable</code> is a delegation mechanism, and apps and add-ons that require delegation will probably want to use the proposed add-on.</p>
<p>The Code Search capabilities of emberobserver are a wonderful way to get a glimpse of how code in the wild is using particular features.</p>
<p>A quick search of the top-scoring add-on packages revealed that most, but by no means all, of the uses of <code>copy()</code> in the modules were for shallow copies that can be accomplished using Object.assign, so a lot of the code affected by this deprecation can rely on a simple substitution.</p>
<p>Very few packages used <code>Copyable</code> - only 9 across the whole set - and most used the feature for only one class.   <code>ember-data-copyable</code> is probably most wedded to the mechanism: it delivers a  <code>Copyable</code>-based mixin for asynchronous copying.  <code>ember-data-model-fragments</code> has pretty open-ended properties. These add-ons would be likely to use the proposed add-on moving forward.   <code>ember-restless</code>, and <code>ember-calendar</code> appear more bounded. Any deep copy mechanism for POJOs may meet their needs.</p>
<h3><a class="header" href="#add-on" id="add-on">Add-on</a></h3>
<p>The add-on will supply the <code>copy()</code> function and the <code>Copyable</code> mixin based on the existing code, modified as indicated above for handling of arrays.</p>
<p>We could treat the add-on as the extraction of a feature from the monolithic <code>ember-source</code>, as was recently done for strings. If we choose to frame it in that way, the naming should follow the conventions set out for extracting elements of Ember into their own packages. If we choose not to frame it that way, then naming is one of the things this section should specify clearly.</p>
<h2><a class="header" href="#how-we-teach-this" id="how-we-teach-this">How we teach this</a></h2>
<h3><a class="header" href="#communication-of-change" id="communication-of-change">Communication of change</a></h3>
<p>We need to inform users that <code>Ember.copy</code> and <code>Ember.Copyable</code> will be dprecated and in what release it will occur. This notification should also point them to the add-on for those who need it.</p>
<h3><a class="header" href="#official-code-bases-and-documentation" id="official-code-bases-and-documentation">Official code bases and documentation</a></h3>
<p>We do not actively teach the use of <code>Ember.copy</code>. It doesn't appear anywhere in our guides, website, or tutorial. Once it is gone from the code, we also need to verify it no longer appears in the API listings.</p>
<p>We must provide an entry in the deprecation guide for this change:</p>
<ul>
<li>describing the use of <code>to = Object.assign({},from)</code> for shallow copies.</li>
<li>pointing out viable alternatives for deep copies.</li>
<li>directing heavy users of deep copies to the addon.</li>
</ul>
<h2><a class="header" href="#drawbacks" id="drawbacks">Drawbacks</a></h2>
<p>The primary drawback is the API churn of people pulling it out of their code. However, for most uses, the change will be straightforward, and the add-on will be available for the foreseeable future for those who want to continue with the implementation.</p>
<h2><a class="header" href="#alternatives" id="alternatives">Alternatives</a></h2>
<p>We could simply leave it in place as a utility for others to use. Even then, it would make sense to split it out into its own module, as has already been done for strings, so the work would be much the same.</p>
<h2><a class="header" href="#unresolved-questions" id="unresolved-questions">Unresolved questions</a></h2>
<p>None at the moment...</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="0318-array-helper.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="0324-deprecate-component-isvisible.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="0318-array-helper.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="0324-deprecate-component-isvisible.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
